<!doctype html>
<html lang="ru">
<head>
    <meta charset="utf-8"/>
    <title>Task 8 – Microservice Integration Test</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600&family=Fira+Code&display=swap" rel="stylesheet">
    <style>
        /* Все стили остаются без изменений, они не мешают */
        :root {
            --bg: #f8fafc; --card: #ffffff; --border: #e2e8f0;
            --text-primary: #1e293b; --text-secondary: #64748b;
            --accent: #4f46e5; --accent-light: #eef2ff; --accent-dark: #4338ca;
            --shadow: 0 4px 6px -1px rgba(0,0,0,.07 ), 0 2px 4px -2px rgba(0,0,0,.07);
        }
        body { font-family: 'Inter', sans-serif; background-color: var(--bg); color: var(--text-primary); line-height: 1.6; margin: 0; padding: 2rem; }
        .container { max-width: 900px; margin: auto; }
        h1, h3 { border-bottom: 1px solid var(--border); padding-bottom: 0.75rem; margin-bottom: 1.5rem; }
        .task-description { background: var(--card); padding: 2rem; border-radius: 0.5rem; box-shadow: var(--shadow); }
        .task-description p { margin: 0 0 1rem; color: var(--text-secondary); }
        .task-description ul { margin-left: 1.5rem; margin-bottom: 1rem; }
        .task-description li { margin-bottom: 0.5rem; }
        code { font-family: 'Fira Code', monospace; background-color: var(--accent-light); color: var(--accent-dark); padding: 0.2em 0.4em; border-radius: 4px; font-size: 0.9em; }
        pre { background-color: #1e293b; color: #e2e8f0; padding: 1rem; border-radius: 0.5rem; font-family: 'Fira Code', monospace; font-size: 0.85rem; white-space: pre-wrap; word-break: break-all; }
    </style>
</head>
<body>
    <div class="container">
        <h1>Задание 8: Тестирование асинхронного API</h1>

        <div class="task-description">
            <h3>Контекст</h3>
            <p>Перед вами API, которое имитирует асинхронную обработку заказа. При создании заказа он сначала получает статус <code>PENDING</code>. Его обработка занимает около <strong>1 секунды</strong>, после чего статус меняется на <code>CONFIRMED</code>.</p>
            <p>Ваша задача — протестировать этот процесс с помощью <strong>Postman</strong>.</p>

            <h3>Описание API</h3>
            <p>API доступно по адресу: <code><span id="api-url"></span></code></p>

            <h4>1. Создание заказа</h4>
            <ul>
                <li><strong>Метод:</strong> <code>POST</code></li>
                <li><strong>Заголовки (Headers):</strong> <code>X-Api-Action: create_order</code></li>
                <li><strong>Тело запроса (Body, raw, JSON):</strong></li>
            </ul>
            <pre>{ "productId": "product-123", "quantity": 5 }</pre>

            <h4>2. Получение информации о заказе</h4>
            <ul>
                <li><strong>Метод:</strong> <code>GET</code></li>
                <li><strong>Заголовки (Headers):</strong>
                    <ul>
                        <li><code>X-Api-Action: get_order</code></li>
                        <li><code>X-Order-Id: &lt;ID вашего заказа&gt;</code></li>
                    </ul>
                </li>
            </ul>

            <h3>Сценарий тестирования</h3>
            <ol>
                <li>Отправьте запрос на создание заказа. Вы получите ответ со статусом <code>PENDING</code>.</li>
                <li>Сразу после этого отправьте запрос на получение информации о заказе. Убедитесь, что статус все еще <code>PENDING</code>.</li>
                <li>Подождите 1-2 секунды и отправьте запрос на получение информации еще раз. Убедитесь, что теперь статус изменился на <code>CONFIRMED</code>.</li>
            </ol>

            <h3>Критерии успеха</h3>
            <ul>
                <li>Вы создали коллекцию в Postman с двумя запросами.</li>
                <li>В запросе на <strong>создание заказа</strong> написан тест, проверяющий статус ответа <code>201 Created</code>.</li>
                <li>В запросе на <strong>получение заказа</strong> написан тест, который проверяет статус <code>200 OK</code> и итоговый статус заказа <code>"CONFIRMED"</code>. Для этого в Postman можно использовать `setTimeout` в тестах, чтобы создать задержку перед отправкой.</li>
                <li>Вы готовы показать и объяснить свою коллекцию и тесты.</li>
            </ul>
        </div>
    </div>

    <script>
        // Этот скрипт просто показывает кандидату правильный URL для API
        const apiUrl = new URL('/api/task8', window.location.origin);
        document.getElementById('api-url').textContent = apiUrl.href;
    </script>
</body>
</html>
